\documentclass[handout]{beamer}

\input{aulas-beamer-preamble}
\usepackage{xcolor}
\usepackage{ulem}


\title[Programação Modular]
{%
	Encapsulamento: Modularidade, Coesão e Acoplamento
}

\author[Prof. Pedro Pongelupe]
{
	Prof.~Pedro Pongelupe
}
\institute[DCC / PUC Minas]
{\epsfig{file=puclogo_small_bw,width=1.5cm} \\
  \textsc{Pontifícia Universidade Católica de Minas Gerais}\\
	Departamento de Ciência da Computação
}
\date[]{}

\lstset{language=Java,
   basicstyle=\scriptsize,
   commentstyle=\color{red},
   showstringspaces=false,
   numbers=none,
   numberstyle=\tiny}

\begin{document}


\selectlanguage{brazil}

\begin{frame}
   \titlepage
\end{frame}

%\addtobeamertemplate{frametitle}{}{%
%	\begin{tikzpicture}[remember picture,overlay]
%	\node[anchor=north east,yshift=2pt] at (current page.north east) {\epsfig{file=puclogo_small_bw,width=1.2cm}};
%	\end{tikzpicture}}


%\addtobeamertemplate{frametitle}{}{%
	%\begin{tikzpicture}[node distance=0cm, remember picture, overlay, every node/.style={inner sep=0,outer sep=0, node distance=0cm, baseline=0cm}]
	%\node[anchor=north east] at (current page.north east) {\epsfig{file=puclogo_small_bw,width=1cm}};
	%\end{tikzpicture}}


%\logo{\includegraphics[height=0.8cm]{puclogo_small_bw.pdf}\vspace{220pt}}


\begin{frame}
   \frametitle{Sumário}
   \tableofcontents[pausesections]
\end{frame}

%\AtBeginSection[] % Do nothing for \section*
%{
%\begin{frame}<beamer>
%\frametitle{Outline}
%\tableofcontents[currentsection]
%\end{frame}}


\addtobeamertemplate{frametitle}{}{%
   \begin{textblock*}{10mm}(.9945\textwidth,-1.72cm)
	   \includegraphics[height=1cm]{puclogo_small_bw.pdf}
   \end{textblock*}
}


\section{Encapsulamento}

\begin{frame}{Encapsulamento: ocultando informações}
        \begin{block}{O quê é??}
                \textit{Encapsular}: "incluir ou proteger em uma cápsula ou como em uma cápsula "
                \begin{itemize}
                        \item Ocultar e proteger o estado 
                        \item Ocultar o progresso 
                        \item Objetiva separar aspectos visíveis de um objeto ou classe  de seus detalhes de implementação

                        \item Interface:
                                \begin{itemize}
                                        \item tudo aquilo que o usuário do objeto vê/acessa.
                                        \item maneira como o usuário utiliza o objeto 
                                \end{itemize}
                \end{itemize}
        \end{block}
\end{frame}

\begin{frame}{Encapsulamento: ocultando informações}
        \begin{itemize}
                \item Permite alterar a implementação de um objeto sem impactos em outros módulos do sistema.
                \item Permite que seus dados sejam protegidos de acesso ilegal.
                \item Em geral, desejamos ocultar determinados dados e/ou métodos do cliente/usuário da aplicação.
        \end{itemize}
\end{frame}


        
\subsection{Modificadores de acesso}     
   
\begin{frame}{Modificadores de acesso}
    \begin{itemize}
        \item Modificadores de acesso controlam a visibilidade dos componentes na aplicação.
        
        \item Ao nível da classe: \lstinline|public| ou \textit{package-private} (sem modificador explícito).
        \begin{itemize}
            \item Classe declarada como  \lstinline|public| é visível a todas as classes do programa.
            \item Classe sem modificador de acesso é visível apenas em seu pacote.
        \end{itemize}
        \item Ao nível dos membros (atributos e métodos): \lstinline|public|, \lstinline|private|, \lstinline|protected|, ou \textit{package-private} (sem modificador explícito).
    \end{itemize}
\end{frame}

\begin{frame}{Modificadores de acesso}
O Java possui 4 modificadores de acesso ao nível dos membros:
    \begin{itemize}
        \item \lstinline|private|: membros declarados com acesso privado são acessíveis apenas na própria classe.
        \item \textit{package-private}: membros declarados sem modificador de acesso são acessíveis apenas às classes dentro do mesmo pacote.
        \item \lstinline|protected|: membros declarados com acesso protegido são acessíveis às classes do pacote e adicionalmente por suas subclasses.
        \item \lstinline|public|: membros declarados com acesso público são acessíveis de qualquer lugar do programa.
    \end{itemize}
\end{frame}

\begin{frame}{Modificadores de acesso Java}
        \begin{table}[h]
                \centering
                \begin{tabular}{ |c|c|c|c|c| }
                        \hline
                        \textbf{Modifier} &\textbf{Class} &\textbf{Package} &\textbf{Subclass} &\textbf{Global}   \\
                        \hline
                        \textbf{public} & \textcolor{green}{sim} & \textcolor{green}{sim}& \textcolor{green}{sim}& \textcolor{green}{sim} \\
                        \hline
                        \textbf{protected} & \textcolor{green}{sim} & \textcolor{green}{sim}& \textcolor{green}{sim}& \textcolor{red}{não} \\
                        \hline
                        \textbf{<default>}  & \textcolor{green}{sim} & \textcolor{green}{sim}& \textcolor{red}{não}& \textcolor{red}{não}\\
                        \hline
                        \textbf{private} & \textcolor{green}{sim} & \textcolor{red}{não}& \textcolor{red}{não}& \textcolor{red}{não}\\
                        \hline
                \end{tabular}
        \end{table}
\end{frame}
\begin{frame}{Princípios da ocultação de informação}
        \begin{itemize}
                \item Use o nível de acesso mais restrito e que faça sentido para um membro particular.
                \item É \lstinline|private|... ou 99\% das vezes, mas aquele 1\% é... 
                \item Evite campos \lstinline|public| exceto para constantes. 
        \end{itemize}
\end{frame}

\begin{frame}[fragile]{Encapsulamento na UML}
\begin{minipage}{.45\textwidth}
    \begin{center}
        \tiny
        \begin{tikzpicture} 
        \umlclass{Shulambs}{ 
            -- atributoPriv : Tipo \\ 
            \# atributoProt : Tipo  
        }{ 
        + getterPub() : Tipo \\ 
        + setterPub(p : Tipo) : void \\
        metodoPkgPriv() : void}        
    \end{tikzpicture}
\end{center}
\end{minipage}%
\begin{minipage}{.45\textwidth}
\begin{lstlisting}
    class Shulambs {
        private Tipo atributoPriv;
        protected Tipo atributoProt;
        
        public Tipo getterPub() {
         ... 
        }
        public void setterPub(Tipo p) {
         ... 
        }
        
        void metodoPkgPriv() {
         ... 
        }
    }
\end{lstlisting}
\end{minipage}
\end{frame}

\subsection{Classe Aluno: encapsulamento}

\begin{frame}[fragile]{Classe Aluno: encapsulamento}
\begin{lstlisting}
public class Aluno {
	private String nome;
	private String matricula;
	private int idade;
	private double[] notas;
	private double media;

  public Aluno(String nome, String matricula, int idade, double... notas) {...}
  public Aluno(String nome, String matricula, int idade) {...}
  public Aluno(String nome, int idade) {...}
  public Aluno(String nome) {...}

  public double getMaiorNota() {...}
 }
\end{lstlisting}
\end{frame}

\subsection{Métodos de acesso}

\begin{frame}{Métodos de acesso (\textit{getters} e \textit{setters})}
    \begin{itemize}
        \item Métodos \textit{get}: acessam o valor de um atributo privado.
        \begin{itemize}
            \item Valores podem ser tratados antes de serem exibidos.
            
        \end{itemize}
        Métodos \textit{set}: atribuem um valor a um atributo privado.
        \begin{itemize}
            \item Valores devem ser validados/tratados antes de serem atribuídos.
        \end{itemize}
    \end{itemize}
    
\end{frame}


\begin{frame}[fragile]{Classe Aluno: métodos de acesso (\textit{getters} e \textit{setters})}
\begin{lstlisting}[basicstyle=\tiny]
    public class Aluno {
    ...
    public String getNome() { return nome; }
    public void setNome(String nome) { this.nome = nome;}

    public String getMatricula() { return matricula;}
    public void setMatricula(String matricula) { this.matricula = matricula;}

    public int getIdade() { return idade;}
    public void setIdade(int idade) { this.idade = idade;}

    public double[] getNotas() { return notas;}
    public void setNotas(double[] notas) { this.notas = notas;}

    public String getMedia() { return media;}
    public void setMedia(double media) { this.matricula = matricula;}
    ...
  }
\end{lstlisting}
\end{frame}


\begin{frame}[fragile]{Classe Produto: acessando membros encapsulados}
\begin{lstlisting}[basicstyle=\tiny]
public class Driver {
	public static void main(String[] args) {
		int n = 3;
		Aluno[] alunos = new Aluno[n];
//		Aluno aluno0 = new Aluno();
//		aluno0.nome = "Pedro";
//		aluno0.matricula = "577028";
//		aluno0.idade = 25;
//		alunos[0] = aluno0;

		alunos[0] = new Aluno("Pedro", "577028", 25);
		alunos[0].setNotas(new double[] {5, 6.8, 9});
		alunos[0].setMedia(10);
		alunos[1] = new Aluno("Aninha", "922955", 28, 10, 9.3, 6);
		alunos[2] = new Aluno("Banana", "579855", 26, 6);

		System.out.println("Alunos registrados: \n");
		for (Aluno aluno : alunos) {
			System.out.println("""
					nome: %s,
					maior nota: %f
					media: %f
					""".formatted(aluno.getNome(),
							aluno.getIdade(),
							aluno.getMedia()));
		}
	}
}
\end{lstlisting}
\end{frame}


\begin{frame}[fragile]{Quando não utilizar métodos de acesso}
\begin{lstlisting}[basicstyle=\tiny]
    public class Aluno {
    ...
    public String getNome() { return nome; }
    public void setNome(String nome) { this.nome = nome;}

    public String getMatricula() { return matricula;}
    public void setMatricula(String matricula) { this.matricula = matricula;}

    public int getIdade() { return idade;}
    public void setIdade(int idade) { this.idade = idade;}

    public double[] getNotas() { return notas;}
    public void setNotas(double[] notas) { this.notas = notas;}

    public String getMedia() { return media;}
    public void setMedia(double media) { this.matricula = matricula;}
    ...
  }
\end{lstlisting}
\end{frame}
\begin{frame}[fragile]{Quando não utilizar métodos de acesso}
\begin{lstlisting}[basicstyle=\tiny]
    public class Aluno {
    ...
    public String getNome() { return nome; }
    public void setNome(String nome) { this.nome = nome;}

    public String getMatricula() { return matricula;}
    public void setMatricula(String matricula) { this.matricula = matricula;}

    public int getIdade() { return idade;}
    public void setIdade(int idade) { this.idade = idade;}

    public double[] getNotas() { return notas;}
    public void setNotas(double[] notas) { this.notas = notas;}

    public String getMedia() { return media;}
    // public void setMedia(double media) { this.matricula = matricula;}
    ...
  }
\end{lstlisting}
\end{frame}
\begin{frame}[fragile]{Quando não utilizar métodos de acesso}
    \begin{minipage}{.4\textwidth}
        \begin{lstlisting}[basicstyle=\tiny]
class Conta {
    private double limite;
    private double saldo;
    
    public double getSaldo() {
        return saldo;
    }
    
    public void setSaldo(double saldo) {
        this.saldo = saldo;
    }
    
    public double getLimite() {
        return limite;
    }
    
    public void setLimite(double limite) {
        this.limite = limite;
    }
}        
\end{lstlisting}
    \end{minipage}%
    \begin{minipage}{.45\textwidth}
        \begin{lstlisting}[basicstyle=\tiny]
        class Conta {
            private double saldo;
            private double limite;
            
            public Conta(double limite) {
                this.limite = limite;
            }
            
            public void depositar(double x) {
                this.saldo += x;
            }
            
            public void sacar(double x) {
                if(this.saldo + this.limite >= x) {
                this.saldo -= x;
                }
                else throw 
                  new Exception("Fundos insuficientes.");
                }
            
            public double getSaldo() {
                return this.saldo;
            }
        }
        \end{lstlisting}
    \end{minipage}
\end{frame}

\section{Modularidade, Coesão e Acoplamento}

\begin{frame}{Modularidade}
        "Mecanismo para aumentar a flexibilidade e compreensibilidade de um sistema, em conjunto com a redução do seu tempo de desenvolvimento." 
       \\ - (Parnas, David L. On the Criteria To Be Used in Decomposing Systems into Modules. 
Communications of the ACM, Vol. 15, No. 12, pp. 1053 - 1058, 1972. Tradução livre do autor.)
    \end{frame}

\begin{frame}{Independência funcional e coesão}
    \begin{itemize}
        \item Módulo: ``grupo de comandos com uma função bem definida e o mais independente possível em relação ao resto do algoritmo''.
        \item Cada módulo deve cuidar de uma função específica, servindo a um propósito específico.
        \item É necessária coerência e unidade conceitual.
    \end{itemize}
\end{frame}

\begin{frame}{Independência funcional e coesão}
    \begin{itemize}
        \item \textbf{Coesão}: Qualidade de uma coisa em que todas as partes estão ligadas umas às outras. Em software, todas as partes estão coerentemente relacionadas.
        \item Objetivo de um módulo em programação modular: \textbf{alta coesão interna}.
        \begin{itemize}
            \item Facilita a manutenção.            
            \item Reduz efeitos colaterais e propagação de erros.            
            \item Dependência deve ser intra-modular: uso de estruturas internas ao módulo.
        \end{itemize}
    \end{itemize}
\end{frame}


\begin{frame}{Independência modular e acoplamento}
    \begin{itemize}
        \item Módulo: ``grupo de comandos com uma função bem definida e o mais independente possível em relação ao resto do algoritmo''.
        \item A dependência pode ser medida pela quantidade de conexões entre os elementos de software.
        \item \textbf{Acoplamento}:
        \begin{itemize}
            \item Medida da interconexão entre os elementos de software.
            \item Situação ideal: baixo acoplamento.
        \end{itemize}
    \end{itemize}
\end{frame}
        

\begin{frame}{Indicadores de baixo acoplamento}
    \begin{itemize}
        \item \textbf{Tamanho}: quantidade de parâmetros e métodos públicos.
        \item \textbf{Visibilidade}: uso de parâmetros x  uso de variáveis globais.
    \end{itemize}
\end{frame}

\begin{frame}[fragile]{Coesão e acoplamento}
\begin{minipage}{.5\textwidth}
    \centering
    \textbf{Alto acoplamento} \\[1mm]
    \includegraphics[width=.9\textwidth]{high.pdf}
\end{minipage}%
\begin{minipage}{.5\textwidth}
    \centering
    \textbf{Baixo acoplamento} \\[1mm]
    \includegraphics[width=.9\textwidth]{low.pdf}
\end{minipage}
\end{frame}
\begin{frame}[fragile]{Bad ending: Código Espaguete}
    \begin{figure}[h]
        \begin{center}
            \includegraphics[width=.6\textwidth]{espaguete.jpg}
        \end{center}
    \end{figure}
\end{frame}


\begin{frame}[fragile]{E então, o quê queremos?}
        \begin{block}{Máxima para desenvolvimento de sistemas modulares}
                \textbf{Alta Coesão e baixo Acoplamento}
        \end{block}
\end{frame}

\section{Exercício}
\begin{frame}[fragile]{Exercício}
        \begin{block}{Classe Hora}
                Projete uma classe \textit{Hora} para ser utilizada em relógios de diversos sistemas.
                A hora será representada até o nível de segundos.
                \begin{itemize}
                        \item Um objeto Hora \textbf{só} pode armazenar estados válidos 
                        \item Um objeto Hora \textbf{só} pode receber incrementos de horas, minutos ou segundos.
                        \item Um objeto Hora pode ser comparado com outro para verificação de qual valor está mais adiante.
                \end{itemize}
        \end{block}
\end{frame}

\begin{frame}[fragile]{Obrigado!!}
        Muito obrigado pela atenção! Alguma dúvida? Bora praticar!!!
        \begin{block}{  }
                "\textit{Tenha fé, porque até no lixão nasce flor.}"
        \end{block}
\end{frame}

\end{document}
